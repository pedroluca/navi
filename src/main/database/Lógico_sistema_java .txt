/* Lógico_sistema_java: */
CREATE DATABASE navi;
USE navi;

CREATE TABLE Usuario_Trilha (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE,
    nome VARCHAR(200),
    email VARCHAR(150),
    senha VARCHAR(500),
    telefone VARCHAR(11),
    sexo CHAR(1),
    id_fase_atual INT,
    nome_do_responsavel VARCHAR(200),
    is_adm BOOLEAN NOT NULL DEFAULT(FALSE)
);

CREATE TABLE Fase (
    xp_necessaria INT,
    xp_atual INT,
    assunto ENUM('Verbo', 'Advérbio', 'Substantivo', 'Pronome', 'Adjetivo'),
    id INT PRIMARY KEY AUTO_INCREMENT
);

CREATE TABLE Questao (
    id INT PRIMARY KEY AUTO_INCREMENT,
    enunciado VARCHAR(1000)
);

CREATE TABLE Alternativa (
    id INT PRIMARY KEY AUTO_INCREMENT,
    texto VARCHAR(200),
    is_correta BOOLEAN,
    id_questao INT
);

CREATE TABLE Fase_Questao (
    id_fase INT,
    id_questao INT,
    PRIMARY KEY (id_fase, id_questao)
);
 
ALTER TABLE Usuario_Trilha ADD CONSTRAINT FK_Usuario_Trilha_3
    FOREIGN KEY (id_fase_atual)
    REFERENCES Fase (id);
 
ALTER TABLE Alternativa ADD CONSTRAINT FK_Alternativa_2
    FOREIGN KEY (id_questao)
    REFERENCES Questao (id);
 
ALTER TABLE Fase_Questao ADD CONSTRAINT FK_Fase_Questao_1
    FOREIGN KEY (id_fase)
    REFERENCES Fase (id);
 
ALTER TABLE Fase_Questao ADD CONSTRAINT FK_Fase_Questao_3
    FOREIGN KEY (id_questao)
    REFERENCES Questao (id);